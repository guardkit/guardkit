---
id: TASK-REV-5796
title: Analyse FEAT-CR01 AutoBuild failure errors
status: review_complete
created: 2026-02-05T16:00:00Z
updated: 2026-02-05T17:00:00Z
priority: high
tags: [autobuild, debugging, context-reduction, feature-build]
task_type: review
complexity: 5
related_tasks: [TASK-REV-5F19]
related_feature: FEAT-CR01
review_results:
  mode: architectural
  depth: standard
  score: 85
  findings_count: 5
  recommendations_count: 4
  decision: implement
  report_path: .claude/reviews/TASK-REV-5796-review-report.md
  implementation_tasks: [TASK-FIX-AB01, TASK-FIX-AB02, TASK-FIX-AB03]
---

# Task: Analyse FEAT-CR01 AutoBuild Failure Errors

## Problem Statement

Running `guardkit autobuild feature FEAT-CR01` failed on all 3 Wave 1 tasks (TASK-CR-001, TASK-CR-002, TASK-CR-003) with 0/10 tasks completed. The feature file and tasks were generated by converting a `/task-review` (TASK-REV-5F19) output into a feature structure, so the errors may stem from that conversion rather than the AutoBuild system itself (which has previously worked successfully).

## Error Log Reference

Full error log: `docs/reviews/graphiti_enhancement/context_reduction_error.md`

## Observed Errors

### Error 1: `AgentInvoker.invoke_player()` unexpected keyword argument `context`

**Location**: `guardkit/orchestrator/autobuild.py:2030`

```
TypeError: AgentInvoker.invoke_player() got an unexpected keyword argument 'context'
```

This error occurs on every Player invocation across all tasks and all turns. The code passes `context=context_prompt` (tagged as TASK-GR6-006 feature) but the `AgentInvoker.invoke_player()` method does not accept a `context` parameter. This is the **primary blocker** - no Player work is ever executed.

### Error 2: Git index.lock conflict (parallel worktree access)

**Location**: `guardkit/orchestrator/worktree_checkpoints.py:292`

```
fatal: Unable to create '.git/worktrees/FEAT-CR01/index.lock': File exists.
```

TASK-CR-002 and TASK-CR-003 fail during checkpoint creation because multiple parallel tasks share the same worktree and the git index.lock is held by another task's `git add -A`. This is a **concurrency issue** with shared worktrees.

### Error 3: Missing `_recovery_count` attribute

**Location**: `guardkit/orchestrator/autobuild.py` (turn state capture)

```
'AutoBuildOrchestrator' object has no attribute '_recovery_count'
```

A secondary error during state capture suggesting an attribute is referenced but never initialised.

### Error 4: Task-work results not found (cascading)

```
task_work_results.json not found at .guardkit/autobuild/TASK-CR-XXX/task_work_results.json
```

This is a **cascading effect** of Error 1 - since Player never executes, no `task_work_results.json` is produced, so Coach has nothing to validate.

## Context

- The FEAT-CR01 feature file was generated from the review output of TASK-REV-5F19
- The conversion from review recommendations to feature tasks may have introduced issues (e.g., task structure, metadata)
- Previous AutoBuild runs (on other features) have worked correctly
- The `context` parameter on `invoke_player()` appears to be from the TASK-GR6-006 (Job-Specific Context Retrieval) feature which may not be fully integrated

## Acceptance Criteria

- [ ] Root cause identified for each of the 4 error categories
- [ ] Determine whether errors stem from feature file conversion or AutoBuild code
- [ ] Check if `invoke_player()` context parameter was added but not matched with method signature update
- [ ] Assess the git index.lock concurrency issue for shared worktrees
- [ ] Verify `_recovery_count` attribute initialisation
- [ ] Provide fix recommendations with priority ordering
- [ ] Assess whether FEAT-CR01 tasks themselves are valid (structure, acceptance criteria)

## Investigation Areas

1. **AgentInvoker.invoke_player() signature** - Does the method accept `context`? Was TASK-GR6-006 partially implemented?
2. **autobuild.py line 2030** - When was the `context=context_prompt` call added?
3. **Shared worktree git locking** - Is there retry/lock handling for parallel tasks?
4. **_recovery_count initialisation** - Where should this be set in `__init__`?
5. **Feature file validity** - Are the FEAT-CR01.yaml tasks well-formed for AutoBuild?
