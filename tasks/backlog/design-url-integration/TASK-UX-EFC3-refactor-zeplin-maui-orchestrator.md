---
id: TASK-UX-EFC3
title: Refactor zeplin-maui-orchestrator to zeplin-orchestrator
status: backlog
created: 2025-11-11T11:00:00Z
updated: 2025-11-11T11:00:00Z
priority: high
tags: [ux-integration, orchestrator, refactoring]
complexity: 0
test_results:
  status: pending
  coverage: null
  last_run: null
---

# Task: Refactor zeplin-maui-orchestrator to zeplin-orchestrator

## Description

Refactor the existing `zeplin-maui-orchestrator.md` agent to be technology-agnostic by removing MAUI-specific naming and making it capable of delegating to any stack's UI specialist.

This is part of Phase 2 of the Design URL Integration project (see [design-url-integration-implementation-guide.md](../../docs/proposals/design-url-integration-implementation-guide.md)).

## Acceptance Criteria

- [ ] Remove MAUI-specific naming and references from orchestrator
- [ ] Make orchestrator technology-agnostic (delegates to any UI specialist)
- [ ] Update delegation pattern to accept stack parameter
- [ ] Keep 6-phase Saga pattern intact
- [ ] Update MCP integration (Zeplin)
- [ ] Update constraint validation to work with any stack
- [ ] File renamed: `zeplin-maui-orchestrator.md` ‚Üí `zeplin-orchestrator.md`
- [ ] Agent name updated: `zeplin-maui-orchestrator` ‚Üí `zeplin-orchestrator`
- [ ] Tests updated (if any exist)

## Implementation Notes

### Source and Target Files
- **Source**: `installer/global/agents/zeplin-maui-orchestrator.md`
- **Target**: `installer/global/agents/zeplin-orchestrator.md`

### Key Changes Required

**1. Rename File**
```bash
mv installer/global/agents/zeplin-maui-orchestrator.md \
   installer/global/agents/zeplin-orchestrator.md
```

**2. Update Agent Metadata**
```markdown
---
name: zeplin-orchestrator  # Was: zeplin-maui-orchestrator
description: Orchestrates Zeplin design extraction and delegates to UI specialists  # Was: ...to .NET MAUI component generation
tools: Read, Write, Grep, mcp__zeplin__*
mcp_dependencies:
  - zeplin (required)
---
```

**3. Update Delegation Pattern**

**Before (MAUI-specific)**:
```typescript
// Use Task tool to delegate to maui-ux-specialist
const componentResult = await invokeAgent({
  agent: "maui-ux-specialist",
  phase: "component-generation",
  // ...
});
```

**After (Technology-agnostic)**:
```typescript
// Use Task tool to delegate to {stack}-ui-specialist
const componentResult = await invokeAgent({
  agent: `${stack}-ui-specialist`,  // Parameterized by stack
  phase: "component-generation",
  input: {
    designElements: designElements,
    designConstraints: designConstraints,
    designMetadata: designMetadata,
  },
  instructions: `
    Generate component matching design exactly for ${stack} stack.

    Requirements:
    - Generate component in stack-appropriate format
    - Apply exact design styling
    - Implement ONLY properties for visible design elements
    - NO loading states, error states, or API integrations

    Constraints: ${JSON.stringify(designConstraints.prohibitions)}
  `
});
```

**4. Remove Stack-Specific Code Examples**

**Before (MAUI-specific examples)**:
```typescript
// Generate .NET MAUI XAML component matching Zeplin design exactly.
// Generate ContentView with XAML
// Generate C# code-behind (minimal logic only)
// Platform-specific adaptations (iOS, Android, Windows, macOS)
```

**After (Generic examples)**:
```typescript
// Generate component matching Zeplin design exactly.
// Generate component in stack-appropriate format
// Apply stack-appropriate styling
// Platform-specific adaptations (where applicable)
```

**5. Update Mission Statement**

**Before**:
> Execute a 6-phase Saga pattern workflow that extracts Zeplin designs, generates MAUI XAML components with C# code-behind, and validates visual fidelity while enforcing strict constraint adherence (zero scope creep).

**After**:
> Execute a 6-phase Saga pattern workflow that extracts Zeplin designs, delegates component generation to stack-specific UI specialists, and validates visual fidelity while enforcing strict constraint adherence (zero scope creep).

**6. Update Success/Failure Reports**

Replace MAUI-specific file paths with generic placeholders:

**Before**:
```markdown
üìÅ Generated Files
- Views/ZeplinComponent.xaml (185 lines)
- Views/ZeplinComponent.xaml.cs (42 lines)
- ViewModels/ZeplinComponentViewModel.cs (68 lines)
- Resources/Styles/ZeplinComponentStyles.xaml (35 lines)
```

**After**:
```markdown
üìÅ Generated Files
- [Stack-appropriate component file] (generated by UI specialist)
- [Stack-appropriate code-behind file] (if applicable)
- [Stack-appropriate view model file] (if applicable)
- [Stack-appropriate test file] (generated by UI specialist)
```

**7. Update Platform Testing References**

**Before (MAUI-specific)**:
```typescript
Platform Adaptations: iOS ‚úÖ, Android ‚úÖ, Windows ‚úÖ, macOS ‚úÖ
```

**After (Generic)**:
```typescript
Platform Adaptations: [As applicable to stack]
```

### Existing 6-Phase Saga Pattern (Keep Intact)

- **Phase 0**: MCP Verification
- **Phase 1**: Design Extraction (via Zeplin MCP)
- **Phase 2**: Boundary Documentation (prohibition checklist)
- **Phase 3**: Component Generation (**delegates to UI specialist**)
- **Phase 4**: Platform Testing (**delegates to UI specialist**)
- **Phase 5**: Constraint Validation (orchestrator validates)

### Delegation Interface

The orchestrator should pass to UI specialists:
```typescript
interface DesignContext {
  designElements: ExtractedElement[];
  designConstraints: ProhibitionChecklist;
  designMetadata: {
    source: "zeplin";
    projectId: string;
    screenId?: string;
    componentId?: string;
    extractedAt: string;
    visualReference: string;
    platform: "ios" | "android" | "web" | "macos" | "multi-platform";
  };
}
```

The orchestrator expects back from UI specialists:
```typescript
interface ComponentResult {
  generated_files: string[];
  visual_fidelity: number;  // 0.0-1.0 (or platform correctness)
  constraint_violations: string[];
  platform_adaptations?: {
    [platform: string]: boolean;
  };
}
```

### Icon Code Conversion

Keep the icon code conversion logic intact (Phase 1) but make it platform-agnostic:

**Before (XAML-specific)**:
```typescript
// Convert icon codes to XAML-compatible format
const result = iconAdapter.convert(originalIcon);
if (result.success && result.xamlFormat) {
  element.properties.style.icon = result.xamlFormat;
}
```

**After (Format-agnostic)**:
```typescript
// Convert icon codes to appropriate format for target stack
const result = iconAdapter.convert(originalIcon, targetFormat: stack);
if (result.success && result.convertedFormat) {
  element.properties.style.icon = result.convertedFormat;
}
```

### Testing Strategy

**Unit Tests**:
- Test each phase independently with mocked delegation
- Verify MCP calls still work
- Verify constraint validation logic
- Test icon code conversion

**Integration Tests**:
- Full Saga execution with mock UI specialist
- Verify orchestrator passes correct context
- Verify orchestrator validates returned results

**Manual Testing**:
- Test with maui-ui-specialist (when created via `/template-create`)
- Test with react-native-ui-specialist (if applicable)

## Test Requirements

- [ ] Unit test: MCP verification phase
- [ ] Unit test: Design extraction phase (Zeplin)
- [ ] Unit test: Boundary documentation phase
- [ ] Unit test: Delegation to UI specialist (mocked)
- [ ] Unit test: Constraint validation phase
- [ ] Unit test: Icon code conversion
- [ ] Integration test: Full Saga with mocked UI specialist
- [ ] Integration test: Orchestrator passes correct design context
- [ ] Integration test: Orchestrator validates UI specialist results
- [ ] Edge case test: UI specialist returns violations
- [ ] Edge case test: UI specialist returns low platform correctness

## Dependencies

**None** - This task can be developed in parallel with TASK-UX-2A61 (figma-orchestrator refactoring) using Conductor + git worktrees.

## Parallel Development

This task is marked for parallel development:

```bash
# Terminal 1
conductor start ux-figma-orchestrator main
cd .conductor/ux-figma-orchestrator
/task-work TASK-UX-2A61

# Terminal 2 (simultaneously)
conductor start ux-zeplin-orchestrator main
cd .conductor/ux-zeplin-orchestrator
/task-work TASK-UX-EFC3
```

## Next Steps

After completing this task:
1. TASK-UX-005: Extend react-ui-specialist to handle design contexts
2. TASK-UX-006: Extend nextjs-ui-specialist to handle design contexts
3. TASK-UX-007: Update task-work Phase 1 to load design URL
4. TASK-UX-008: Update task-work Phase 3 to route to orchestrators

## References

- [Design URL Integration Proposal](../../docs/proposals/design-url-integration-proposal.md)
- [Implementation Guide - Phase 2](../../docs/proposals/design-url-integration-implementation-guide.md#phase-2-refactor-orchestrators-parallel)
- [Existing Zeplin MAUI Orchestrator](../../installer/global/agents/zeplin-maui-orchestrator.md)

## Implementation Estimate

**Duration**: 3-4 hours

**Complexity**: 5/10 (Medium)
- Rename and refactor existing agent
- Update delegation pattern
- Remove stack-specific references
- Keep 6-phase Saga pattern intact
- Keep icon code conversion logic
- Mostly refactoring, not new code

## Test Execution Log

_Automatically populated by /task-work_
