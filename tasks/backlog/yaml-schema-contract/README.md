# FEAT-YSC: YAML Schema Contract Enforcement

## Problem

Feature YAML files generated by commands (`/feature-plan`, `/system-plan`, manual AI creation) repeatedly fail `FeatureLoader` validation because there is no single source of truth for the schema. The same class of bug has occurred at least twice (TASK-REV-66B4 in Jan 2026, FEAT-AC1A in Feb 2026).

Root cause: the schema is implicit in Python dataclasses, no validation occurs at write time, and `.get()` with defaults silently accepts invalid values.

## Solution

1. **Canonical Pydantic schema** - Replace dataclasses with Pydantic models that enforce types at parse time
2. **Write-time validation** - Validate YAML against schema before writing to disk
3. **Schema documentation** - Add schema reference to all command specs that generate feature YAMLs
4. **CLI validation** - `guardkit feature validate FEAT-XXX` pre-flight check
5. **Test coverage** - Tests for invalid values, extra fields, and generator round-trips

## Tasks

| ID | Title | Wave | Complexity | Status |
|----|-------|------|-----------|--------|
| TASK-YSC-001 | Add schema ref to system-plan.md | 1 | 2 | backlog |
| TASK-YSC-002 | Create Pydantic schema models | 1 | 6 | backlog |
| TASK-YSC-003 | Add schema validation tests | 2 | 4 | backlog |
| TASK-YSC-004 | Add write-time validation | 2 | 4 | backlog |
| TASK-YSC-005 | CLI validate command | 3 | 4 | backlog |

## Getting Started

See [IMPLEMENTATION-GUIDE.md](IMPLEMENTATION-GUIDE.md) for wave breakdown and execution strategy.
