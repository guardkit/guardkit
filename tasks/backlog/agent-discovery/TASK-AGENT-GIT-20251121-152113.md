# TASK-AGENT-GIT: Create git-workflow-manager.md Agent

**Task ID**: TASK-AGENT-GIT-20251121-120300
**Priority**: MEDIUM (P2)
**Status**: BACKLOG
**Created**: 2025-11-21
**Tags**: agents, git, workflow, vcs, github-best-practices

---

## Overview

Create new `git-workflow-manager.md` agent to cover Git workflow patterns, addressing the 6th core area from GitHub's best practices analysis (currently 0% coverage).

**Current Problem**:
- No agent covers Git workflow, branching, commits, or PRs
- Developers inconsistent with commit messages, branch naming
- PR workflow unclear (when to create, what to include)
- Missing from GitHub's "six core areas" (Commands, Testing, Structure, Style, Git, Boundaries)

**GitHub's Six Core Areas**:
1. Commands ✅
2. Testing ✅
3. Project Structure ✅
4. Code Style ⚠️ (scattered)
5. **Git Workflow** ❌ ← THIS TASK
6. Boundaries ❌ (TASK-AGENT-BOUND)

**Impact**: Standardizes Git workflow, improves commit quality, clarifies PR process

---

## Acceptance Criteria

### AC1: Agent File Structure

Create `installer/global/agents/git-workflow-manager.md` with:

```markdown
---
name: git-workflow-manager
description: Git workflow specialist for branch naming, commits, and PRs
---

# Git Workflow Manager

## What I Do
Manages Git workflow conventions: branch naming, commit messages (Conventional Commits), PR creation, and merge strategies.

**Key Responsibilities**:
- Enforce branch naming conventions (feature/fix/hotfix/release)
- Validate commit message format (Conventional Commits standard)
- Guide PR creation workflow and timing
- Recommend merge strategies (merge/squash/rebase)
- Manage tags and releases

**When I Run**: Throughout development workflow, integrated with task-manager

## Quick Start

[10-20 code examples of good/bad Git practices]

## Boundaries

### ALWAYS
[5-7 Git workflow rules]

### NEVER
[5-7 Git anti-patterns]

### ASK
[3-5 situations requiring human decision]

## How It Works
[Detailed workflow documentation]

## Reference
[Advanced topics, edge cases]
```

**Acceptance**:
- [ ] Agent file created with complete structure
- [ ] Follows new agent structure from TASK-AGENT-STRUCT
- [ ] Has 10-20 code examples in Quick Start
- [ ] Has explicit ALWAYS/NEVER/ASK boundaries
- [ ] Covers all 5 key responsibilities

---

### AC2: Branch Naming Conventions

**Document standard branch patterns**:

```markdown
## Branch Naming Conventions

### ✅ DO: Descriptive Branch Names
```bash
# Feature branches
feature/TASK-042-user-authentication
feature/add-payment-gateway

# Bug fix branches
fix/TASK-043-null-pointer-exception
fix/login-timeout-issue

# Hotfix branches (production urgent)
hotfix/security-vulnerability-CVE-2024-1234
hotfix/payment-processing-down

# Release branches
release/v1.2.0
release/2024-Q1
```

### ❌ DON'T: Vague or Personal Branch Names
```bash
# Too vague
fix-stuff
new-feature
updates

# Personal naming
johns-branch
temp-branch
test123
```

**Pattern**: `{type}/{task-id}-{description}` or `{type}/{description}`

**Types**: feature, fix, hotfix, release, docs, refactor, test
```

**Acceptance**:
- [ ] Branch naming patterns documented
- [ ] Examples for each branch type
- [ ] Integration with task IDs shown
- [ ] Anti-patterns clearly marked

---

### AC3: Conventional Commits Standard

**Enforce commit message format**:

```markdown
## Commit Message Format (Conventional Commits)

### ✅ DO: Structured Commit Messages
```bash
# Feature commit
feat(auth): add JWT token generation

Implement JSON Web Token authentication with:
- Token generation with 24-hour expiry
- Refresh token support
- Secure secret key management

Tests: 15/15 passing, 92% coverage
Closes TASK-042

# Bug fix commit
fix(api): prevent null pointer in user lookup

Check for null user before accessing properties.
Added defensive null check at UserService:67.

Fixes #123

# Breaking change commit
feat(api)!: remove deprecated /v1/users endpoint

BREAKING CHANGE: /v1/users endpoint removed.
Migrate to /v2/users with pagination support.

Migration guide: docs/api-migration-v2.md
```

### ❌ DON'T: Vague Commit Messages
```bash
# Too vague
git commit -m "fixed stuff"
git commit -m "updates"
git commit -m "wip"

# No context
git commit -m "changed file"
git commit -m "bug fix"
```

**Format**: `{type}({scope}): {description}`

**Types**: feat, fix, docs, style, refactor, test, chore
**Scope**: Component/module affected (optional)
**Description**: Imperative mood, lowercase, no period

**Breaking Changes**: Add `!` after type or `BREAKING CHANGE:` in body
```

**Acceptance**:
- [ ] Conventional Commits standard documented
- [ ] Format breakdown explained (type, scope, description)
- [ ] Examples for common commit types
- [ ] Breaking change format shown
- [ ] Task ID integration documented

---

### AC4: PR Creation Workflow

**Guide PR creation timing and content**:

```markdown
## Pull Request Workflow

### When to Create PR

#### ✅ DO: Create PR After Phase 4 (Tests Passing)
```bash
# Workflow sequence
git checkout -b feature/TASK-042-user-auth

# Phase 2-3: Implementation
[code changes]
git add .
git commit -m "feat(auth): implement JWT token generation"

# Phase 4: Tests passing
npm test  # All tests pass ✅
git commit -m "test(auth): add token expiry tests"

# Phase 4.5: Coverage verified
npm run coverage  # ≥80% coverage ✅

# NOW: Create PR
git push origin feature/TASK-042-user-auth
gh pr create --title "feat(auth): Add JWT token generation" \
  --body "$(cat <<'PREOF'
## Summary
Implements JWT-based authentication with 24-hour token expiry.

## Changes
- JWT token generation with secure secret key
- Refresh token support for seamless re-authentication
- Token validation middleware

## Test Coverage
- 15/15 tests passing
- 92% line coverage (target: ≥80%)
- Security: No hardcoded secrets

## Checklist
- [x] Tests pass
- [x] Coverage ≥80%
- [x] Code reviewed (Phase 5)
- [x] Documentation updated
- [x] No breaking changes

## Related
Closes TASK-042
PREOF
)"
```

#### ❌ DON'T: Create PR Too Early
```bash
# DON'T: Create PR before tests pass
git push origin feature/TASK-042-user-auth
gh pr create  # Tests failing ❌

# DON'T: Create PR before code review
gh pr create  # Phase 5 not complete ❌

# DON'T: Create PR with placeholder title
gh pr create --title "WIP" ❌
```

### PR Template

```markdown
## Summary
[One-paragraph description of what this PR does]

## Changes
- [Change 1]
- [Change 2]
- [Change 3]

## Test Coverage
- X/X tests passing
- Y% line coverage (target: ≥80%)
- [Any special testing notes]

## Checklist
- [ ] Tests pass (100% required)
- [ ] Coverage ≥80% lines, ≥75% branches
- [ ] Code reviewed (Phase 5)
- [ ] Documentation updated
- [ ] No breaking changes (or migration guide provided)

## Related
Closes TASK-XXX
Fixes #123
```
```

**Acceptance**:
- [ ] PR creation timing documented (after Phase 4)
- [ ] PR template provided
- [ ] gh CLI commands shown
- [ ] PR content requirements clear
- [ ] Integration with task workflow

---

### AC5: Merge Strategies

**Document when to use merge/squash/rebase**:

```markdown
## Merge Strategies

### Strategy Selection

| Strategy | When to Use | Result |
|----------|-------------|--------|
| **Merge** | Feature branches with meaningful history | All commits preserved |
| **Squash** | Small fixes, cleanup commits | Single commit in main |
| **Rebase** | Keep linear history, update branch | No merge commit |

### ✅ DO: Choose Strategy Based on Context

#### Merge (Preserve History)
```bash
# Use for: Feature branches with 5+ meaningful commits
git checkout main
git merge --no-ff feature/TASK-042-user-auth
# Result: Merge commit + all feature commits visible
```

**When**: Feature development with distinct logical commits

#### Squash (Simplify History)
```bash
# Use for: Bug fixes, typo fixes, small cleanup PRs
gh pr merge --squash
# Result: Single commit "feat(auth): Add JWT token generation (#42)"
```

**When**: Multiple WIP commits that should be one logical change

#### Rebase (Linear History)
```bash
# Use for: Keeping feature branch up-to-date with main
git checkout feature/TASK-042-user-auth
git rebase main
git push --force-with-lease
```

**When**: Updating branch without merge commits

### ❌ DON'T: Force Push to Main
```bash
# NEVER do this
git checkout main
git push --force  # ❌ Destroys team's work
```

### ❌ DON'T: Squash Multi-Feature Branches
```bash
# DON'T: Squash 50 commits from large feature
gh pr merge --squash  # ❌ Loses valuable history
# DO: Merge to preserve commit context
gh pr merge --merge
```
```

**Acceptance**:
- [ ] All 3 strategies documented
- [ ] Decision matrix provided
- [ ] Examples for each strategy
- [ ] Anti-patterns shown (force push)
- [ ] Integration with PR workflow

---

### AC6: Tag and Release Management

**Document versioning and release workflow**:

```markdown
## Tags and Releases

### Semantic Versioning

**Format**: `vMAJOR.MINOR.PATCH`

- **MAJOR**: Breaking changes (v1.0.0 → v2.0.0)
- **MINOR**: New features, backwards compatible (v1.2.0 → v1.3.0)
- **PATCH**: Bug fixes, backwards compatible (v1.2.3 → v1.2.4)

### ✅ DO: Tag After Merge to Main
```bash
# After PR merged to main
git checkout main
git pull

# Create annotated tag with release notes
git tag -a v1.2.0 -m "Release v1.2.0

## Features
- JWT token authentication (TASK-042)
- User profile endpoints (TASK-043)

## Fixes
- Null pointer in user lookup (TASK-044)

## Breaking Changes
None
"

# Push tag
git push origin v1.2.0

# Create GitHub release
gh release create v1.2.0 --notes "$(git tag -l --format='%(contents)' v1.2.0)"
```

### ❌ DON'T: Tag Before Testing
```bash
# DON'T: Tag before CI passes
git tag v1.2.0  # ❌ Tests not verified
git push origin v1.2.0
```

### Release Workflow

```
1. Merge all PRs for release → main
2. Run full CI/CD pipeline ✅
3. Create release branch (optional): release/v1.2.0
4. Create annotated tag: v1.2.0
5. Push tag: git push origin v1.2.0
6. Create GitHub release with notes
7. Deploy to production (if applicable)
```
```

**Acceptance**:
- [ ] Semantic versioning explained
- [ ] Tag creation workflow documented
- [ ] GitHub release integration shown
- [ ] Release workflow steps clear
- [ ] Anti-patterns documented

---

## Boundaries

```markdown
## Boundaries

### ALWAYS (Non-Negotiable)
- **Use Conventional Commits format** for all commits (type(scope): description)
- **Branch naming convention** required (feature/fix/hotfix/release)
- **PR after tests pass** (Phase 4.5 complete, 100% pass rate)
- **Include task ID** in branch name and PR description (traceability)
- **No force push to main** (protected branch, team safety)

### NEVER (Will Be Rejected)
- **Vague commit messages** ("fixed stuff", "updates", "wip" in PR)
- **PR before tests pass** (100% pass rate required)
- **Direct commits to main** (all changes via PR)
- **Force push to main** (destroys team's work)
- **Squash multi-feature PRs** (loses valuable history)

### ASK (Escalate to Human)
- **Breaking changes** → Require migration guide and major version bump
- **Force push to feature branch** → Confirm no one else working on branch
- **Hotfix to production** → Expedited review process, skip some quality gates?
- **Large PR (>20 files)** → Consider splitting into smaller PRs?
```

---

## Integration with task-manager

**Show how git-workflow-manager integrates**:

```markdown
## Integration with Task Workflow

### Phase 2: Planning
- [ ] Create feature branch: `feature/TASK-XXX-{description}`

### Phase 3: Implementation
- [ ] Commit frequently with Conventional Commits format
- [ ] Reference task ID in commits: `feat(auth): ... (TASK-042)`

### Phase 4: Testing
- [ ] Verify tests pass before PR
- [ ] Commit test changes: `test(auth): add token expiry tests`

### Phase 4.5: Test Enforcement
- [ ] All tests pass (100% required)
- [ ] Coverage ≥80% lines, ≥75% branches

### Phase 5: Code Review
- [ ] Create PR with template
- [ ] Link to task: `Closes TASK-XXX`
- [ ] Code review complete → Approve PR

### Phase 6: Merge (After task-complete)
- [ ] Merge PR to main
- [ ] Delete feature branch
- [ ] Tag release (if applicable)
```

---

## Testing

### Test 1: Branch Naming Validation
```bash
# Create test branch with correct format
git checkout -b feature/TASK-999-test-branch

# Verify naming convention
if [[ "$BRANCH_NAME" =~ ^(feature|fix|hotfix|release)/ ]]; then
    echo "✅ Valid branch name"
else
    echo "❌ Invalid branch name"
fi
```

### Test 2: Commit Message Validation
```bash
# Test commit message format
MSG="feat(auth): add JWT token generation"

if [[ "$MSG" =~ ^(feat|fix|docs|style|refactor|test|chore)\(.+\):.+ ]]; then
    echo "✅ Valid Conventional Commit"
else
    echo "❌ Invalid commit format"
fi
```

### Test 3: PR Creation After Tests
```bash
# Verify tests pass before PR
npm test || exit 1  # ✅ Tests pass
npm run coverage || exit 1  # ✅ Coverage ≥80%

# Now create PR
gh pr create --title "feat(auth): Add JWT token generation"
```

---

## Related Documents

- **Source**: GitHub AGENTS.md best practices (Git workflow core area)
- **Standard**: Conventional Commits (conventionalcommits.org)
- **Integration**: task-manager.md (workflow phases)

---

## Workflow

```bash
# 1. Create task
/task-work TASK-AGENT-GIT

# 2. Create agent file (2 hours)
# - Write agent structure
# - Add Quick Start examples

# 3. Document workflows (2 hours)
# - Branch naming
# - Commit format
# - PR workflow
# - Merge strategies
# - Tags/releases

# 4. Add boundaries (30 min)
# - ALWAYS rules
# - NEVER rules
# - ASK situations

# 5. Integration (30 min)
# - Show task-manager integration
# - Add to workflow phases

# 6. Testing (1 hour)
# - Test branch naming
# - Test commit validation
# - Test PR workflow

# 7. Complete task
/task-complete TASK-AGENT-GIT
```

---

## Notes

**Why Git Workflow Agent Needed**:
- GitHub's "six core areas" include Git workflow
- Currently 0% coverage in Taskwright agents
- Inconsistent Git practices across team
- No standard for commit messages or PR workflow

**Developer Impact**:
- **Before**: "How should I name this branch? What commit format?"
- **After**: "Clear patterns documented, I know exactly what to do"

**Team Benefits**:
- Consistent Git history (easier to understand changes)
- Better traceability (task IDs in branches/commits/PRs)
- Clearer PR workflow (when to create, what to include)
- Standardized releases (semantic versioning)

---

**Created**: 2025-11-21
**Estimated Effort**: 6 hours
**Expected Impact**: 100% Git workflow coverage (was 0%)
**Status**: BACKLOG
**Ready for Implementation**: YES
