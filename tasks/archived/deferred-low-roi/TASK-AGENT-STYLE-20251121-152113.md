# TASK-AGENT-STYLE: Create code-style-enforcer.md Agent

**Task ID**: TASK-AGENT-STYLE-20251121-120400
**Priority**: MEDIUM (P2)
**Status**: BACKLOG
**Created**: 2025-11-21
**Tags**: agents, code-style, linting, formatting, github-best-practices

---

## Overview

Create new `code-style-enforcer.md` agent to centralize code style standards, addressing GitHub's 4th core area (currently scattered across multiple agents).

**Current Problem**:
- Code style guidance scattered across code-reviewer, architectural-reviewer
- No centralized reference for linting, formatting, naming conventions
- Inconsistent style standards between agents
- Missing from GitHub's "six core areas" as unified resource

**GitHub's Six Core Areas**:
1. Commands ✅
2. Testing ✅
3. Project Structure ✅
4. **Code Style** ⚠️ ← THIS TASK (unify scattered guidance)
5. Git Workflow ❌ (TASK-AGENT-GIT)
6. Boundaries ❌ (TASK-AGENT-BOUND)

**Impact**: Centralizes style standards, improves consistency, clarifies linting expectations

---

## Acceptance Criteria

### AC1: Agent File Structure

Create `installer/core/agents/code-style-enforcer.md` with:

```markdown
---
name: code-style-enforcer
description: Code style specialist for linting, formatting, and naming conventions
---

# Code Style Enforcer

## What I Do
Centralizes code style standards: linting configuration, formatting rules, import ordering, naming conventions per technology stack.

**Key Responsibilities**:
- Define linting standards (ESLint, flake8, StyleCop)
- Specify formatting rules (Prettier, Black, C# EditorConfig)
- Document import ordering conventions
- Enforce naming conventions (PascalCase, camelCase, snake_case)
- Provide pre-commit hook configurations

**When I Run**: Integrated with code-reviewer (Phase 5), enforces during review

## Quick Start

[10-20 code examples of good/bad style practices]

## Boundaries

### ALWAYS
[5-7 style enforcement rules]

### NEVER
[5-7 style anti-patterns]

### ASK
[3-5 situations requiring style decisions]

## How It Works
[Detailed style documentation per stack]

## Reference
[Linter configs, pre-commit hooks, IDE settings]
```

**Acceptance**:
- [ ] Agent file created with complete structure
- [ ] Follows new agent structure from TASK-AGENT-STRUCT
- [ ] Has 10-20 code examples in Quick Start
- [ ] Has explicit ALWAYS/NEVER/ASK boundaries
- [ ] Covers all 5 key responsibilities

---

### AC2: Stack-Specific Style Standards

**Document style standards per technology**:

#### Python (Black, isort, flake8)

```markdown
## Python Style Standards

### Formatting (Black)

#### ✅ DO: Use Black defaults
```python
# Black auto-formats to consistent style
def calculate_user_score(
    user_id: int,
    include_bonus: bool = False,
    max_score: int = 100,
) -> int:
    """Calculate user score with optional bonus."""
    score = get_base_score(user_id)
    if include_bonus:
        score += get_bonus_points(user_id)
    return min(score, max_score)
```

#### ❌ DON'T: Manual inconsistent formatting
```python
# Inconsistent spacing, line breaks
def calculate_user_score(user_id: int, include_bonus: bool=False, max_score:int=100)->int:
    score=get_base_score(user_id)
    if include_bonus: score+=get_bonus_points(user_id)
    return min(score,max_score)
```

### Import Ordering (isort)

#### ✅ DO: Organize imports
```python
# Standard library
import os
import sys
from typing import List, Optional

# Third-party
import pytest
from fastapi import FastAPI

# Local
from app.models import User
from app.services import UserService
```

#### ❌ DON'T: Random import order
```python
from app.models import User
import os
import pytest
from app.services import UserService
import sys
```

### Naming Conventions

```python
# ✅ DO: Consistent naming
class UserService:  # PascalCase for classes
    def get_user_by_id(self, user_id: int):  # snake_case for functions
        MAX_RETRIES = 3  # UPPERCASE for constants
        user_name = "John"  # snake_case for variables
        
# ❌ DON'T: Inconsistent naming
class userService:  # Wrong: Use PascalCase
    def GetUserByID(self, UserID: int):  # Wrong: Use snake_case
        maxRetries = 3  # Wrong: Use UPPERCASE
```

### Configuration Files

**pyproject.toml**:
```toml
[tool.black]
line-length = 100
target-version = ['py311']

[tool.isort]
profile = "black"
line_length = 100

[tool.flake8]
max-line-length = 100
extend-ignore = E203, W503
```
```

**Acceptance**:
- [ ] Python formatting standards (Black)
- [ ] Import ordering (isort)
- [ ] Naming conventions (PascalCase, snake_case)
- [ ] Configuration files provided
- [ ] Examples for each standard

---

#### TypeScript/React (Prettier, ESLint)

```markdown
## TypeScript/React Style Standards

### Formatting (Prettier)

#### ✅ DO: Use Prettier defaults
```typescript
// Prettier auto-formats consistently
interface UserProfile {
  id: number;
  name: string;
  email: string;
  createdAt: Date;
}

function getUserProfile(userId: number): Promise<UserProfile> {
  return fetch(`/api/users/${userId}`)
    .then((response) => response.json())
    .catch((error) => {
      console.error("Failed to fetch user", error);
      throw error;
    });
}
```

#### ❌ DON'T: Inconsistent formatting
```typescript
interface UserProfile{id:number;name:string;email:string;}

function getUserProfile(userId:number):Promise<UserProfile>{
return fetch(`/api/users/${userId}`).then(response=>response.json())
.catch(error=>{console.error("Failed to fetch user",error);throw error;})}
```

### React Component Naming

#### ✅ DO: PascalCase components, camelCase props
```typescript
// Component: PascalCase
interface UserCardProps {
  userId: number;      // Props: camelCase
  showAvatar: boolean;
  onUserClick: () => void;
}

export function UserCard({ userId, showAvatar, onUserClick }: UserCardProps) {
  const userName = "John";  // Variables: camelCase
  return <div onClick={onUserClick}>{userName}</div>;
}
```

#### ❌ DON'T: Inconsistent naming
```typescript
// Wrong casing
function userCard({ UserID, show_avatar }: userCardProps) {
  const user_name = "John";  // Wrong: Use camelCase
  return <div>{user_name}</div>;
}
```

### Import Ordering (ESLint)

#### ✅ DO: Group imports
```typescript
// React/framework
import React from 'react';
import { useState, useEffect } from 'react';

// Third-party
import { z } from 'zod';
import axios from 'axios';

// Internal
import { UserService } from '@/services/UserService';
import { Button } from '@/components/Button';

// Types
import type { User } from '@/types';
```

### Configuration Files

**.prettierrc**:
```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "singleQuote": true,
  "trailingComma": "es5"
}
```

**.eslintrc.json**:
```json
{
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:react/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "react/prop-types": "off"
  }
}
```
```

**Acceptance**:
- [ ] TypeScript formatting (Prettier)
- [ ] React component naming (PascalCase)
- [ ] Import ordering (ESLint)
- [ ] Configuration files provided
- [ ] Examples for each standard

---

#### C#/.NET (StyleCop, EditorConfig)

```markdown
## C#/.NET Style Standards

### Naming Conventions

#### ✅ DO: Follow .NET conventions
```csharp
// Interfaces: IPascalCase
public interface IUserService
{
    // Methods: PascalCase
    Task<User> GetUserByIdAsync(int userId);
    
    // Properties: PascalCase
    int MaxRetries { get; set; }
}

// Classes: PascalCase
public class UserService : IUserService
{
    // Private fields: _camelCase
    private readonly ILogger<UserService> _logger;
    private readonly int _maxRetries = 3;
    
    // Constants: PascalCase
    private const int DefaultTimeout = 30;
    
    // Public properties: PascalCase
    public int MaxRetries { get; set; }
    
    // Methods: PascalCase
    public async Task<User> GetUserByIdAsync(int userId)
    {
        // Local variables: camelCase
        var userName = "John";
        var userEmail = "john@example.com";
        
        return await _repository.GetByIdAsync(userId);
    }
}
```

#### ❌ DON'T: Inconsistent naming
```csharp
// Wrong naming conventions
public interface userService  // Wrong: Use IPascalCase
{
    Task<User> get_user_by_id(int user_id);  // Wrong: Use PascalCase, not snake_case
}

public class UserService
{
    private readonly ILogger logger;  // Wrong: Use _camelCase for private fields
    public int max_retries { get; set; }  // Wrong: Use PascalCase
}
```

### File Organization

#### ✅ DO: One class per file
```csharp
// File: UserService.cs
namespace MyApp.Services
{
    public class UserService
    {
        // Implementation
    }
}

// File: IUserService.cs
namespace MyApp.Services
{
    public interface IUserService
    {
        // Interface definition
    }
}
```

### Configuration Files

**.editorconfig**:
```ini
[*.cs]
# Indentation
indent_style = space
indent_size = 4

# Naming conventions
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.severity = warning
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.symbols = interface
dotnet_naming_rule.interfaces_should_be_prefixed_with_i.style = begins_with_i

# StyleCop rules
dotnet_diagnostic.SA1633.severity = none  # File header
dotnet_diagnostic.SA1200.severity = warning  # Using directives placement
```

**Directory.Build.props**:
```xml
<Project>
  <ItemGroup>
    <PackageReference Include="StyleCop.Analyzers" Version="1.2.0-beta.435">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>
</Project>
```
```

**Acceptance**:
- [ ] C# naming conventions (PascalCase, _camelCase)
- [ ] Interface naming (IPascalCase)
- [ ] File organization (one class per file)
- [ ] Configuration files (EditorConfig, StyleCop)
- [ ] Examples for each standard

---

### AC3: Pre-Commit Hook Configuration

**Provide pre-commit hooks for each stack**:

```markdown
## Pre-Commit Hooks

### Python (.pre-commit-config.yaml)

```yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.11.0
    hooks:
      - id: black
        language_version: python3.11

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort
        args: ["--profile", "black"]

  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8
        args: ["--max-line-length=100"]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.7.0
    hooks:
      - id: mypy
        additional_dependencies: [types-all]
```

### TypeScript/React (.husky/pre-commit)

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run Prettier
npm run format:check || exit 1

# Run ESLint
npm run lint || exit 1

# Run type check
npm run type-check || exit 1
```

### C#/.NET (Directory.Build.targets)

```xml
<Project>
  <Target Name="FormatCode" BeforeTargets="Build">
    <Exec Command="dotnet format --verify-no-changes" />
  </Target>
  
  <Target Name="StyleCopCheck" BeforeTargets="Build">
    <Exec Command="dotnet build /p:EnforceCodeStyleInBuild=true" />
  </Target>
</Project>
```

### Installation

```bash
# Python
pip install pre-commit
pre-commit install

# TypeScript/React
npm install --save-dev husky lint-staged
npx husky install

# C#/.NET
dotnet tool install -g dotnet-format
```
```

**Acceptance**:
- [ ] Pre-commit hooks for Python
- [ ] Pre-commit hooks for TypeScript/React
- [ ] Pre-commit hooks for C#/.NET
- [ ] Installation instructions provided
- [ ] Integration with Git workflow

---

### AC4: IDE Configuration

**Provide IDE settings for each editor**:

```markdown
## IDE Configuration

### VS Code (settings.json)

```json
{
  // Python
  "python.formatting.provider": "black",
  "python.linting.flake8Enabled": true,
  "python.linting.mypyEnabled": true,
  "editor.formatOnSave": true,
  
  // TypeScript/React
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  
  // C#
  "omnisharp.enableEditorConfigSupport": true,
  "omnisharp.enableRoslynAnalyzers": true
}
```

### Visual Studio (.editorconfig - already provided above)

### JetBrains IDEs (PyCharm, WebStorm, Rider)

```xml
<!-- .idea/codeStyleSettings.xml -->
<component name="ProjectCodeStyleConfiguration">
  <code_scheme name="Project" version="173">
    <option name="LINE_SEPARATOR" value="&#10;" />
    <Python>
      <option name="OPTIMIZE_IMPORTS_ON_THE_FLY" value="true" />
    </Python>
    <TypeScript>
      <option name="USE_SEMICOLON_AFTER_STATEMENT" value="true" />
    </TypeScript>
  </code_scheme>
</component>
```
```

**Acceptance**:
- [ ] VS Code settings provided
- [ ] Visual Studio config (EditorConfig)
- [ ] JetBrains IDE settings
- [ ] Settings apply on save (auto-format)
- [ ] Integration with linters enabled

---

## Boundaries

```markdown
## Boundaries

### ALWAYS (Non-Negotiable)
- **Auto-format on save**: All code auto-formatted before commit (Black, Prettier, dotnet format)
- **Run linters pre-commit**: ESLint, flake8, StyleCop execute before commit (block if fail)
- **Enforce naming conventions**: PascalCase, camelCase, snake_case per language standards
- **100-120 character line length**: Consistent across stacks (Black 100, Prettier 100, C# 120)
- **Import ordering**: Group imports (standard lib, third-party, local)

### NEVER (Will Be Rejected)
- **Manual formatting**: Never manually format code (use Black/Prettier/dotnet format)
- **Inconsistent naming**: Never mix camelCase and snake_case within same language
- **Ignore linter errors**: Never disable linters without team approval
- **Skip pre-commit hooks**: Never bypass hooks with `--no-verify` (except emergencies)
- **Trailing whitespace**: Never commit code with trailing spaces (auto-remove)

### ASK (Escalate to Human)
- **Line length >120**: Code exceeds limit, refactor needed? Or adjust limit?
- **Linter rule conflicts**: ESLint rule conflicts with team practice, disable?
- **Custom naming convention**: Special case (e.g., API requires snake_case), document exception?
- **IDE conflicts**: Developer's IDE doesn't support EditorConfig, alternative?
```

---

## Integration with code-reviewer

**Show how code-style-enforcer integrates**:

```markdown
## Integration with Code Reviewer

### Phase 5: Code Review
code-reviewer delegates style checks to code-style-enforcer:

1. **Pre-review**: Run linters (ESLint, flake8, StyleCop)
2. **Style check**: Verify formatting (Black, Prettier, dotnet format)
3. **Naming check**: Validate conventions (PascalCase, camelCase, snake_case)
4. **Import check**: Verify import ordering (isort, ESLint import plugin)

### Decision Flow

```
code-reviewer (Phase 5)
    ↓
    ├─ Build verification (PASS)
    ├─ Test verification (PASS)
    ↓
code-style-enforcer
    ├─ Linter check (ESLint/flake8/StyleCop)
    ├─ Format check (Black/Prettier/dotnet format)
    ├─ Naming check (conventions per stack)
    ├─ Import order check
    ↓
    PASS → Continue to quality review
    FAIL → Block with style violations
```

### Example Output

```markdown
## Style Violations Detected

### Formatting (Black)
- Line 42: Line too long (125 > 100 characters)
- Line 67: Missing trailing comma in multi-line list

### Linting (flake8)
- Line 89: F401 'os' imported but unused
- Line 103: E501 line too long (110 > 100 characters)

### Naming (Python conventions)
- Line 56: Function `GetUser` should be `get_user` (snake_case)
- Line 78: Constant `maxRetries` should be `MAX_RETRIES` (UPPERCASE)

**Action**: Run `black .` and `isort .` to auto-fix formatting, then address linting errors.
```
```

---

## Testing

### Test 1: Auto-Format Verification
```bash
# Python
black --check .
isort --check-only .
flake8 .

# TypeScript/React
npm run format:check
npm run lint

# C#/.NET
dotnet format --verify-no-changes
dotnet build /p:EnforceCodeStyleInBuild=true
```

### Test 2: Pre-Commit Hook Execution
```bash
# Make code change with style violations
echo "def badFunction( x,y ): return x+y" > test.py

# Attempt commit (should be blocked)
git add test.py
git commit -m "test"
# Expected: Black fails, commit blocked

# Fix formatting
black test.py

# Retry commit
git commit -m "test"
# Expected: Success
```

### Test 3: IDE Integration
1. Open project in VS Code/Visual Studio/JetBrains
2. Write code with style violations
3. Save file
4. **Expected**: Auto-formatted on save
5. **Verify**: Linter errors shown inline

---

## Related Documents

- **Source**: GitHub AGENTS.md best practices (Code Style core area)
- **Standards**: PEP 8 (Python), Airbnb Style Guide (JS/TS), .NET Framework Design Guidelines (C#)
- **Integration**: code-reviewer.md (Phase 5 style enforcement)

---

## Workflow

```bash
# 1. Create task
/task-work TASK-AGENT-STYLE

# 2. Create agent file (2 hours)
# - Write agent structure
# - Add Quick Start examples

# 3. Document stack standards (3 hours)
# - Python (Black, isort, flake8)
# - TypeScript/React (Prettier, ESLint)
# - C#/.NET (StyleCop, EditorConfig)

# 4. Pre-commit hooks (1 hour)
# - Python (.pre-commit-config.yaml)
# - TypeScript/React (.husky)
# - C#/.NET (Directory.Build.targets)

# 5. IDE configs (1 hour)
# - VS Code settings
# - Visual Studio EditorConfig
# - JetBrains settings

# 6. Integration (30 min)
# - Link to code-reviewer
# - Update Phase 5 workflow

# 7. Testing (30 min)
# - Test auto-format
# - Test pre-commit hooks
# - Test IDE integration

# 8. Complete task
/task-complete TASK-AGENT-STYLE
```

---

## Notes

**Why Code Style Agent Needed**:
- GitHub's "six core areas" include Code Style
- Currently scattered across multiple agents
- No centralized linting/formatting reference
- Inconsistent style standards between agents

**Developer Impact**:
- **Before**: "Which linter rules apply? What's the line length?"
- **After**: "One agent has all style standards, clear and centralized"

**Team Benefits**:
- Consistent code style across entire codebase
- Auto-formatting prevents style debates
- Pre-commit hooks catch issues before review
- IDE integration provides instant feedback

---

**Created**: 2025-11-21
**Estimated Effort**: 8 hours
**Expected Impact**: Centralized style standards (was scattered)
**Status**: BACKLOG
**Ready for Implementation**: YES
